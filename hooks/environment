#!/bin/bash
set -euo pipefail

echo "Using Plugins: BUILDKITE_PLUGINS"

# TODO: Fix warning for unbound var
DISALLOWED=$(echo $BUILDKITE_PLUGINS | jq -c '[.[] | select(."ca-johnson/perforce" | not)]')
if [ "$DISALLOWED" != '[]' ]; then
    echo "Warning: Using plugins that havn't been whitelisted: ${DISALLOWED}"
    exit 0
fi
